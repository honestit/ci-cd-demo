name: CI/CD

on:
  workflow_dispatch:
  push:
    branches:
    - main

jobs:
  qa:
    name: Running tests
    runs-on: ubuntu-latest
    steps:
    # checkout code
    - uses: actions/checkout@v1
    # setup java 11
    - uses: actions/setup-java@v1
      with:
        java-version: '11'
    # cache mvn downloads for same pom.xml content
    - uses: actions/cache@v1
      with:
        path: ~/.m2
        key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}
        restore-keys: ${{ runner.os }}-m2
    # run tests
    - run: mvn -B test